{"version":3,"sources":["assets/Script/BetArea.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ChipStyle from \"./Style/ChipStyle\";\n\nconst CHIP_PREFAB = 'AnimChipPrefab';\n\nconst {ccclass, property} = cc._decorator;\n\nconst VIEW_EVENT = {\n    ON_CLICK_BET_AREA: \"ON_CLICK_BET_AREA\"\n};\n@ccclass\nexport default class BetArea extends cc.Component {\n    readonly VIEW_EVENT = VIEW_EVENT;\n\n    private _allreadyBetCoin: number;\n    private _betCoin: number;\n    private _betLabel: cc.Label;\n    private _areaNameLabel: cc.Label;\n    private _animChipNode: cc.Node;\n    private _areaIndex: number;\n    private _unCheckAnimChip: cc.Node[];\n    private _checkAnimChip: cc.Node[];\n    private _eventDispatcher: Function = null;\n    private _animChipPrefab: cc.Prefab;\n\n    onLoad(){\n        this._areaIndex = 0;\n        this._allreadyBetCoin = 0;\n        this._betCoin = 0;\n        this._unCheckAnimChip = [];\n        this._checkAnimChip = [];\n        this._betLabel = this.node.getChildByName(\"Background\").getChildByName(\"BetLabel\").getComponent(cc.Label);\n        this._areaNameLabel = this.node.getChildByName(\"Background\").getChildByName(\"AreaNameLabel\").getComponent(cc.Label);\n        this._animChipNode = this.node.getChildByName(\"Background\").getChildByName(\"AnimChipNode\");\n        this._updateBetLabel();\n        cc.resources.load(CHIP_PREFAB, (error: Error, asset: cc.Asset) => {this._animChipPrefab = asset as cc.Prefab});\n    };\n\n    showBet(chipValue: number){\n        let node = cc.instantiate(this._animChipPrefab);\n        this._animChipNode.addChild(node);\n        node.getComponent(ChipStyle).setChipValue(chipValue);\n        \n        // 调整筹码飞的区域\n        let width = this.node.width - 100;\n        let height = this.node.height - 100;\n        let finalPos = cc.v3(\n            Math.random() * width - width / 2,\n            Math.random() * height - height / 2\n        );\n        node.setPosition(node.convertToNodeSpaceAR(cc.v2(0, 0)));\n        cc.tween(node)\n        .to(0.5, { position: finalPos, angle: Math.random() * 360 })\n        .start();\n        this._unCheckAnimChip.push(node);\n    };\n\n    reset(){\n        this._unCheckAnimChip.forEach((node) => node.destroy());\n        this._unCheckAnimChip = [];\n        this._checkAnimChip.forEach((node) => node.destroy());\n        this._checkAnimChip = [];\n        this.setBetCoin(0);\n        this.setAllreadyBetCoin(0);\n    };\n\n    confirmBet(){\n        this._unCheckAnimChip.forEach((node) => this._checkAnimChip.push(node));\n        this._unCheckAnimChip = [];\n    };\n\n    cancelBet(){\n        this._unCheckAnimChip.forEach((node) => node.destroy());\n        this._unCheckAnimChip = [];\n    };\n\n    registerClickEvent(){\n        let clickEventHandler = new cc.Component.EventHandler();\n        clickEventHandler.target = this.node;\n        clickEventHandler.component = \"BetArea\";\n        clickEventHandler.handler = \"_onClick\";\n        this.node.getComponent(cc.Button).clickEvents.push(clickEventHandler);\n    };\n\n    setEventDispatcher(eventDispatcher: Function){\n        this._eventDispatcher = eventDispatcher;\n    };\n\n    setTouchEnabled(isEnabled: boolean){\n        this.node.getComponent(cc.Button).interactable = isEnabled;\n    };\n\n    setAreaIndex(index: number){\n        this._areaIndex = index;\n    };\n\n    setAreaName(areaName: string){\n        this._areaNameLabel.string = areaName;\n    };\n\n    setAllreadyBetCoin(betCoin: number){\n        this._allreadyBetCoin = betCoin;\n        this._updateBetLabel();\n    };\n\n    getAllreadyBetCoin(): number{\n        return this._allreadyBetCoin;\n    };\n\n    setBetCoin(betCoin: number){\n        this._betCoin = betCoin;\n        this._updateBetLabel();\n    };\n\n    getBetCoin(): number{\n        return this._betCoin;\n    };\n\n    private _onClick(event: Event, customEventData: any){\n        this._eventDispatcher(VIEW_EVENT.ON_CLICK_BET_AREA, this._areaIndex);\n    };\n\n    private _updateBetLabel(){\n        let text = \"\";\n        if (this._allreadyBetCoin > 0 && this._betCoin > 0) {\n            text = `${this._allreadyBetCoin} + (${this._betCoin})`;\n        } else if (this._betCoin > 0) {\n            text = `(${this._betCoin})`;\n        } else {\n            text = `${this._allreadyBetCoin}`;\n        };\n        this._betLabel.string = \"下注：\" + text;\n    };\n}\n"]}